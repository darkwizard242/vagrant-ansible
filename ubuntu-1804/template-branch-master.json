{
   "variables":{
      "cloud_token":"{{ env `VAGRANT_CLOUD_TOKEN` }}",
      "version":"1.0.{{timestamp}}",
      "box":"",
      "release_description":"Ansible pre-loaded {{user `box`}} vagrant box."
   },
   "builders":[
      {
         "communicator":"ssh",
         "source_path":"ubuntu/bionic64",
         "provider":"virtualbox",
         "add_force":true,
         "type":"vagrant",
         "output_dir":"artifacts-box"
      }
   ],
   "provisioners":[
      {
         "type":"file",
         "source":"mods",
         "destination":"/home/vagrant/"
      },
      {
         "type":"shell",
         "execute_command":"echo 'password' | {{.Vars}} sudo -S -E bash '{{.Path}}'",
         "inline":[
            "sudo apt-get update",
            "sudo apt-get upgrade -y",
            "/home/vagrant/mods/01-init.sh",
            "/home/vagrant/mods/02-vagrant_init.sh",
            "/home/vagrant/mods/03-ansible.sh install",
            "mods/cleanup.sh"
         ]
      }
   ],
   "post-processors":[
      {
         "type":"vagrant-cloud",
         "box_tag":"darkwizard242/ansibleubuntu1804",
         "access_token":"{{user `cloud_token`}}",
         "version":"{{user `version`}}",
         "version_description":"{{user `release_description`}}"
      }
   ]
}
